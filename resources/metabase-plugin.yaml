info:
  name: Metabase Databricks Spark SQL Driver (v2)
  version: 1.0.0-SNAPSHOT
  description: Allows Metabase to connect to Databricks Spark SQL databases.
driver:
  - name: hive-like
    lazy-load: true
    abstract: true
    parent: sql-jdbc
  - name: sparksql-databricks-v2
    display-name: Databricks SQL (v2)
    lazy-load: true
    parent: hive-like
    connection-properties:
      - merge:
        - host
        - placeholder: "<account>.cloud.databricks.com"
      - name: http-path
        display-name: HTTP Path
        placeholder: "/sql/1.0/warehouses/<id>"
      - name: app-id
        display-name: App ID
        placeholder: "9af18267-60e7-4061-b2d5-e2414af88b0b"
      - name: app-secret
        display-name: App Secret
        placeholder: "doseXXXXXXXXXXXX"
      - name: catalog
        display-name: Catalog
        placeholder: "<catalog-name>"
      - merge:
          - port
          - default: 443
      - merge:
          - dbname
          - required: false
      - advanced-options-start
      - merge:
          - additional-options
          - name: jdbc-flags
            placeholder: ";transportMode=http;ssl=1;"
      - default-advanced-options
    connection-properties-include-tunnel-config: false
init:
  - step: load-namespace
    namespace: metabase.driver.sparksql-databricks-v2
  - step: register-jdbc-driver
    class: metabase.driver.FixedSparkDriver
